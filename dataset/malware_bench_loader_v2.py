import os.path


class MalwareBenchV2:
    def __init__(self, path, eco_from, load_mal=True, load_no_mal=True, k=None):
        assert load_mal or load_no_mal and (not (load_mal and load_no_mal))
        self.path = os.path.join(path, eco_from, "malware" if load_mal else "false_positive")
        self.file_list = os.listdir(self.path)
        if k is not None:
            self.file_list = self.file_list[:k]

    def __iter__(self):
        for package_path in self.file_list:
            yield os.path.join(self.path, package_path)
